webpackJsonp([1],{"2L4A":function(t,e){},"5OHe":function(t,e){},"9Vsi":function(t,e,o){t.exports=o.p+"static/img/tximg.a103af5.jpg"},"9n10":function(t,e){},A5V8:function(t,e){},C2g4:function(t,e){},C4aK:function(t,e){},C7Wu:function(t,e){},D50z:function(t,e){},EaV8:function(t,e){},FGKU:function(t,e){},HSlS:function(t,e){},M6Sr:function(t,e){},"MyR+":function(t,e,o){t.exports=o.p+"static/img/sl.3d69e08.jpg"},NHnr:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=o("xd7I"),n={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view"),this._v(" "),e("lg-preview")],1)},staticRenderFns:[]};var i=o("C7Lr")({name:"App"},n,!1,function(t){o("kuOz")},null,null).exports,s=o("7LQH"),r=o("Muz9"),l=o.n(r),c=o("CtzY"),d=o.n(c),u={name:"GGMap",data:function(){return{map:null,lineId:null,latlngs:[]}},created:function(){this.mapCoorIni()},destroyed:function(){},mounted:function(){this.polylin()},methods:{mapCoorIni:function(){null!=this.$route.params.lineId?(this.lineId=this.$route.params.lineId,console.log("进入地图")):this.$router.push({path:"/resources"})},polylin:function(){var t=this;l.a.post(this.SrcApi+"/systemLine/gpsOfLine",d.a.stringify({lineId:t.lineId}),{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then(function(e){if(1e3==e.data.state)if(null!=e.data.data&&0!=e.data.data.length){for(var o=e.data.data,a=0;a<o.length;a++){var n=[o[a].latitude,o[a].longitude];t.latlngs.push(n)}var i=L.tileLayer.chinaProvider("GaoDe.Normal.Map",{maxZoom:18,minZoom:5}),s=L.tileLayer.chinaProvider("GaoDe.Satellite.Map",{maxZoom:18,minZoom:5}),r=L.tileLayer.chinaProvider("GaoDe.Satellite.Annotion",{maxZoom:18,minZoom:5}),l=L.layerGroup([i]);L.layerGroup([s,r]);t.map=L.map("map",{center:t.latlngs[0],zoom:15,layers:[l],zoomControl:!0});for(var c=0;c<t.latlngs.length;c++){var d=t.latlngs[c];L.marker(d).addTo(t.map)}var u=t.latlngs;L.polyline(u,{color:"red"}).addTo(t.map)}else t.$router.push({path:"/resources"});else t.$router.push({path:"/resources"})}).catch(function(t){console.log(t)})}}},m={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"MapBox"},[e("mt-header",{attrs:{title:"查看线路"}},[e("router-link",{attrs:{slot:"left",to:"/resources"},slot:"left"},[e("mt-button",{attrs:{icon:"back"}})],1)],1),this._v(" "),e("div",{attrs:{id:"map"}})],1)},staticRenderFns:[]};var p=o("C7Lr")(u,m,!1,function(t){o("VxGX")},"data-v-0d1778ad",null).exports,f={name:"GGMap",data:function(){return{map:null,lineId:null,latlngs:[]}},created:function(){this.mapCoorIni()},destroyed:function(){},mounted:function(){this.polylin()},methods:{mapCoorIni:function(){null!=this.$route.params.lineId?(this.lineId=this.$route.params.lineId,console.log("进入地图")):this.$router.push({path:"/history"})},polylin:function(){var t=this;l.a.post(this.SrcApi+"/line/gpsOfLine",d.a.stringify({lineId:t.lineId}),{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then(function(e){if(1e3==e.data.state)if(null!=e.data.data&&0!=e.data.data.length){for(var o=e.data.data,a=0;a<o.length;a++){var n=[o[a].latitude,o[a].longitude];t.latlngs.push(n)}var i=L.tileLayer.chinaProvider("GaoDe.Normal.Map",{maxZoom:18,minZoom:5}),s=L.tileLayer.chinaProvider("GaoDe.Satellite.Map",{maxZoom:18,minZoom:5}),r=L.tileLayer.chinaProvider("GaoDe.Satellite.Annotion",{maxZoom:18,minZoom:5}),l=L.layerGroup([i]);L.layerGroup([s,r]);t.map=L.map("map",{center:t.latlngs[0],zoom:15,layers:[l],zoomControl:!0});for(var c=0;c<t.latlngs.length;c++){var d=t.latlngs[c];L.marker(d).addTo(t.map)}var u=t.latlngs;L.polyline(u,{color:"red"}).addTo(t.map)}else t.$router.push({path:"/history"});else t.$router.push({path:"/history"})}).catch(function(t){console.log(t)})}}},h={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"MapBox"},[e("mt-header",{attrs:{title:"查看线路"}},[e("router-link",{attrs:{slot:"left",to:"/history"},slot:"left"},[e("mt-button",{attrs:{icon:"back"}})],1)],1),this._v(" "),e("div",{attrs:{id:"map"}})],1)},staticRenderFns:[]};var g=o("C7Lr")(f,h,!1,function(t){o("hTWl")},"data-v-72d35388",null).exports,v=o("3cXf"),y=o.n(v),w=o("wSez"),_=o.n(w),b={name:"logoin",data:function(){return{msg:"logoin",userName:"",userPwd:"",nameSta:"",pwdSta:"",LoaginData:{userName:"chengkun",userPwd:130130}}},methods:{Logion:function(){var t=this;l.a.post(this.SrcApi+"/user/login",d.a.stringify({name:t.userName,password:t.userPwd}),{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then(function(e){if(1e3==e.data.state){var o=y()(e.data.data);window.plus?plus.storage.setItem("appUser",o):localStorage.setItem("appUser",o),t.$router.push({path:"/"})}else Object(w.Toast)({message:e.data.message,iconClass:"icon icon-success"})}).catch(function(t){console.log(t),Object(w.Toast)({message:t,iconClass:"icon icon-success"})})}}},k={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"logoin"},[t._m(0),t._v(" "),o("div",{staticClass:"box"},[o("mt-field",{attrs:{label:"用户名",state:t.nameSta,placeholder:"请输入用户名"},model:{value:t.userName,callback:function(e){t.userName=e},expression:"userName"}}),t._v(" "),o("mt-field",{attrs:{label:"密码",state:t.pwdSta,placeholder:"请输入密码",type:"password"},model:{value:t.userPwd,callback:function(e){t.userPwd=e},expression:"userPwd"}}),t._v(" "),o("div",{staticClass:"Dboorder"}),t._v(" "),o("mt-button",{staticClass:"loginBtn",attrs:{type:"danger",size:"large"},on:{click:t.Logion}},[t._v("登录")])],1)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"logo"},[e("img",{attrs:{src:o("dLd/")}})])}]};var C=o("C7Lr")(b,k,!1,function(t){o("qqfu")},"data-v-46c920d0",null).exports,x={name:"index",data:function(){return{msg:"index",userNmae:"",dataTime:""}},methods:{goDetails:function(t){var e=t;""!=e&&null!=e&&this.$router.push({name:e})},signOut:function(){if(window.plus)plus.storage.removeItem("appUser");else localStorage.removeItem("appUser");this.$router.push({path:"/logion"})},modify:function(){this.$router.push({path:"/modify"})},getTime:function(){var t=new Date,e=t.getFullYear(),o=t.getMonth(),a=t.getDate(),n=(t.getDay(),t.getHours()),i=t.getMinutes(),s=t.getSeconds();(o+=1)<10&&(o="0"+o),a<10&&(a="0"+a),n<10&&(n="0"+n),i<10&&(i="0"+i),s<10&&(s="0"+s);return e+"-"+o+"-"+a}},created:function(){this.getLogion(),this.userNmae=this.getUser().name,this.dataTime=this.getTime()}},I={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"index"}},[o("mu-flex",{staticClass:"flex-wrapper",attrs:{"justify-content":"center"}},[o("mu-flex",{staticClass:"flex-demo-left",attrs:{"justify-content":"center"}},[o("mu-menu",{attrs:{cover:""}},[o("mu-button",{attrs:{icon:""}},[o("i")]),t._v(" "),o("mu-list",{attrs:{slot:"content"},slot:"content"},[o("mu-list-item",{attrs:{button:""},on:{click:t.modify}},[o("mu-list-item-title",[t._v("修改密码")])],1),t._v(" "),o("mu-list-item",{attrs:{button:""},on:{click:t.signOut}},[o("mu-list-item-title",[t._v("退出")])],1)],1)],1)],1),t._v(" "),o("mu-flex",{staticClass:"flex-demo-center",attrs:{"justify-content":"center"}},[o("mu-flex",{staticClass:"flex-demo-name",attrs:{"justify-content":"center"}},[t._v(t._s(t.userNmae))]),t._v(" "),o("mu-flex",{staticClass:"flex-demo-time",attrs:{"justify-content":"center"}},[t._v(t._s(t.dataTime))])],1),t._v(" "),o("mu-flex",{staticClass:"flex-demo-right",attrs:{"justify-content":"center"}})],1),t._v(" "),o("div",{staticClass:"index-cont"},[o("mu-flex",{staticClass:"cot-wrapper",attrs:{"justify-content":"center"}},[o("mu-flex",{staticClass:"cot-wrapper-nav lx",attrs:{"justify-content":"center"},on:{click:function(e){return t.goDetails("Resources")}}},[t._v("线路资源")]),t._v(" "),o("mu-flex",{staticClass:"cot-wrapper-nav rw",attrs:{"justify-content":"center"},on:{click:function(e){return t.goDetails("Task")}}},[t._v("巡检任务")])],1),t._v(" "),o("mu-flex",{staticClass:"cot-wrapper",attrs:{"justify-content":"center"}},[o("mu-flex",{staticClass:"cot-wrapper-nav dw",attrs:{"justify-content":"center"},on:{click:function(e){return t.goDetails("Fault")}}},[t._v("故障定点")]),t._v(" "),o("mu-flex",{staticClass:"cot-wrapper-nav xj",attrs:{"justify-content":"center"},on:{click:function(e){return t.goDetails("Free")}}},[t._v("自由巡检")])],1),t._v(" "),o("mu-flex",{staticClass:"cot-wrapper",attrs:{"justify-content":"center"}},[o("mu-flex",{staticClass:"cot-wrapper-nav lsjl",attrs:{"justify-content":"center"},on:{click:function(e){return t.goDetails("History")}}},[t._v("历史记录")]),t._v(" "),o("mu-flex",{staticClass:"cot-wrapper-nav lxr",attrs:{"justify-content":"center"},on:{click:function(e){return t.goDetails("myUser")}}},[t._v("用户")])],1)],1),t._v(" "),o("div",{staticClass:"bottom"},[t._v("岳阳联通线路巡检")])],1)},staticRenderFns:[]};var T=o("C7Lr")(x,I,!1,function(t){o("2L4A")},"data-v-5d8df43e",null).exports,M=o("6xlI"),P={name:"Fault",data:function(){return{msg:"故障定点",dataList:"",open:!1,docked:!1,lineId:"",typeContent:"",type:"",longitude:"",latitude:"",resourList:[],xldwList:[]}},methods:{getXLDWList:function(t){var e=this;l.a.post(this.SrcApi+"/systemLine/gpsOfLine",d.a.stringify({lineId:t.id}),{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then(function(t){1e3==t.data.state&&(e.dataList=t.data.data,e.showAdd())}).catch(function(t){console.log(t)})},getData:function(){var t=this;l.a.post(this.SrcApi+"/systemLine/list",d.a.stringify({pageNum:t.pageSize}),{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then(function(e){1e3==e.data.state&&(t.resourList=e.data.data.list)}).catch(function(t){console.log(t)})},getDataList:function(){var t=this;l.a.post(this.SrcApi+"/systemGps/list",d.a.stringify({pageNum:1e3}),{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then(function(e){1e3==e.data.state&&(console.log("查询成功"),t.dataList=e.data.data.list,console.log(t.dataList))}).catch(function(t){console.log(t)})},showAdd:function(){this.open=!this.open},add:function(){var t=this;navigator.geolocation?(console.log("/* 地理位置服务可用 */"),navigator.geolocation.getCurrentPosition(function(e){var o=t.getUser().creatUserId;t.latitude=e.coords.latitude,t.longitude=e.coords.longitude,l.a.post(t.SrcApi+"/systemGps/addGps",d.a.stringify({type:t.type,typeContent:t.typeContent,lineId:t.lineId,longitude:t.latitude,latitude:t.latitude,userId:o}),{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then(function(e){console.log(e.data.state),1e3==e.data.state&&(t.showAdd(),t.getDataList(),Notify({type:"success",message:"添加成功"}))}).catch(function(t){console.log(t)})},function(){console.log("定位失败，请打开手机定位")})):console.log("/* 地理位置服务不可用 */")},deleteBtn:function(t){var e=this;M.a.confirm({title:"标题",message:"是否确定表位故障点位？"}).then(function(){var o=e.getUser().creatUserId;l.a.post(e.SrcApi+"/systemGps/addGps",d.a.stringify({lineId:t.lineId,userId:o,statusContent:"故障点位",latitude:t.latitude,longitude:t.longitude}),{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then(function(t){console.log(t.data.state),t.data.state}).catch(function(t){console.log(t)})}).catch(function(){})},goMap:function(t){this.$router.push({name:"faultMap",params:t})}},created:function(){this.getDataList(),this.getData()}},S={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"Fault"}},[o("mu-drawer",{attrs:{open:t.open,docked:t.docked,width:"100%",right:"right"},on:{"update:open":function(e){t.open=e}}},t._l(t.resourList,function(e,a){return o("mt-cell-swipe",{key:a,attrs:{title:e.name,right:[{content:"查看",style:{background:"blue",color:"#fff"},handler:function(){return t.getXLDWList(e)}}]}})}),1),t._v(" "),o("mt-header",{attrs:{title:t.msg}},[o("router-link",{attrs:{slot:"left",to:"/"},slot:"left"},[o("mt-button",{attrs:{icon:"back"}},[t._v("返回")])],1),t._v(" "),o("mt-button",{attrs:{slot:"right",icon:"more"},on:{click:function(e){return t.showAdd()}},slot:"right"})],1),t._v(" "),t._l(t.dataList,function(e,a){return o("mt-cell-swipe",{key:a,attrs:{title:e.statusContent,right:[{content:"故障",style:{background:"red",color:"#fff"},handler:function(){return t.deleteBtn(e)}},{content:"查看",style:{background:"blue",color:"#fff"},handler:function(){return t.goMap(e)}}]}})})],2)},staticRenderFns:[]};var F=o("C7Lr")(P,S,!1,function(t){o("k/K1")},"data-v-6905b40a",null).exports,A=o("a3Yh"),$=o.n(A),D=o("MyR+"),U=o.n(D),O=o("UKTf"),z=o.n(O),R=o("qqHy"),j=o.n(R),B={name:"Free",data:function(){var t;return t={img_w:window.screen.width/33.333*.94*.5+"rem",msg:"自由巡检",end:[113.5,29.48],Start:[],map:null,timer:null,myPostion:null,lines:[],myPolyline:null,myMarker:null,lineId:null,userId:null,statusContent:"自由巡检",ifFree:!1,showAdd:!1,docked:!1,position:"right",labelPosition:"top",param:new FormData,form:{Content:""},open:!1,minImg:null},$()(t,"userId",""),$()(t,"img",U.a),$()(t,"items",[{title:"图片查看",img_url:o("MyR+")}]),$()(t,"showMap",!1),$()(t,"windowMap",null),$()(t,"selectPosition",null),$()(t,"myMarker",null),$()(t,"endNum",0),t},components:{Previewer:z.a},destroyed:function(){this.ifFree?(console.log("清除定时器"),this.endPatrol()):console.log("定时器未开启")},created:function(){this.userId=this.getUser().id},mounted:function(){this.inIMap()},methods:{update:function(t){var e=j()(this.$el).find("#imgLocal")[0].files[0];console.log(j()(this.$el).find("#imgLocal")[0].files),self.img=j()(this.$el).find("#imgLocal")[0].files[0],(new FormData).append("imgFile",e)},saveFault:function(){var t=this,e=new FormData;console.log(t.minImg),e.append("imgFile",t.minImg),e.append("userId",t.userId),null!=t.form.Content&&""!=t.form.Content&&(e.append("content",t.form.Content),null!=t.selectPosition&&0!=t.selectPosition.length&&(e.append("longitude",t.selectPosition[1]),e.append("latitude",t.selectPosition[0]),console.log(e),console.log(e.get("imgFile")),l.a.post(this.SrcApi+"/trouble/addTrouble",e).then(function(e){1e3==e.data.state?(t.showAdd=!t.showAdd,w.MessageBox.alert("上报成功","操作")):(t.showAdd=!t.showAdd,w.MessageBox.alert("上传失败请重新上传","操作")),console.log(e.data.state),console.log(e.data.message)}).catch(function(t){console.log(t)})))},saveImg:function(){var t=this;console.log("图片地址"+t.$store.state.user.icon),plus.gallery.save(t.$store.state.user.icon,function(){t.$toast.success("保存图片到相册成功"),t.open=!1},function(){t.$toast.error("保存失败")})},getBase64Image:function(t){var e=this,o=new Image;o.src=t,o.onload=function(){var t=o,a=t.width,n=t.height,i=a/n;n=(a=320)/i;var s=document.createElement("canvas"),r=s.getContext("2d");j()(s).attr({width:a,height:n}),r.drawImage(t,0,0,a,n);var l=s.toDataURL("image/png","image/jpeg","image/jpg",1);console.log(l),e.minImg=l}},setImg:function(){var t=this;plus.camera.getCamera().captureImage(function(e){plus.io.resolveLocalFileSystemURL(e,function(e){t.minImg=t.getBase64Image(e.toLocalURL()),t.items[0].img_url=e.toLocalURL()},function(t){})},function(t){},{filename:"_doc/camera/"})},resolveImg:function(t){this.open=!1;var e=this,o=t.substr(t.lastIndexOf("/")+1);plus.io.resolveLocalFileSystemURL(t,function(a){a.file(function(a){a.size;plus.zip.compressImage({src:t,dst:"_doc/"+o,width:"100%",quality:100,overwrite:!0},function(t){console.log("压缩成功--\x3e"+t.target);var o=new Image;o.src=t.target,o.style.width="60px",o.style.height="60px",e.minImg=e.getBase64Image(o)})})},function(t){alert("Resolve file URL failed: "+t.message)})},endPatrol:function(){var t=this;t.endNum<=1?Object(w.Toast)({message:"巡检时间未到，不能结束！",position:"bottom",duration:1e3}):l.a.post(t.SrcApi+"/line/upDateFinish",d.a.stringify({id:t.lineId})).then(function(e){1e3==e.data.state?(t.ifFree=!1,window.clearTimeout(t.timer),Object(w.Toast)({message:"已结束自由巡检",position:"bottom",duration:1e3})):Object(w.Toast)({message:"自由巡检结束失败，请重新结束！",position:"bottom",duration:1e3})}).catch(function(t){console.log(t),Object(w.Toast)({message:"自由巡检结束失败，请重新结束！",position:"bottom",duration:1e3})})},inIMap:function(){var t=this;navigator.geolocation?(console.log("/* 地理位置服务可用 */"),navigator.geolocation.getCurrentPosition(function(e){var o=e.coords.latitude,a=e.coords.longitude;o-=.0026496046771,a-=-.0058125257492,t.map=L.map("MapFree",{center:[o,a],zoom:15}),L.tileLayer("http://webrd0{s}.is.autonavi.com/appmaptile?lang=zh_cn&size=1&scale=1&style=8&x={x}&y={y}&z={z}",{subdomains:["1","2","3","4"],attribution:"高德"}).addTo(t.map);var n=[],i=[o,a],s=new L.Marker(i);n.push(s),t.myMarker=L.layerGroup(n),t.map.addLayer(t.myMarker)},function(){console.log("/* 地理位置请求失败 */"),w.MessageBox.alert("地理位置请求失败,请打开定位设置!").then(function(e){t.$router.push({path:"/"})})},{enableHighAccuracy:!0,timeout:5e3,maximumAge:1e3})):console.log("/* 地理位置服务不可用 */")},AddMarker:function(t,e){var o=this;l.a.post(o.SrcApi+"/gps/addGps",d.a.stringify({lineId:o.lineId,userId:o.userId,statusContent:o.statusContent,longitude:e,latitude:t}),{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then(function(a){if(1e3!=a.data.state)return Object(w.Toast)({message:"添加点位失败",position:"bottom",duration:1e3}),void console.log("添加点位失败");console.log("添加点位成功"),console.log("第一次进入"),o.myMarker.clearLayers(),console.log("清除点位标志"),o.myPostion=[t,e];var n=[],i=[t,e],s=new L.Marker(i);n.push(s),o.lines.push(i),o.myMarker=L.layerGroup(n),o.map.addLayer(o.myMarker)}).catch(function(t){o.endPatrol(),console.log(t)})},addPolylin:function(t,e){var o=this,a=L.latLng(o.myPostion).distanceTo(L.latLng([t,e]));if(a>=50)o.myPostion=[t,e],l.a.post(o.SrcApi+"/gps/addGps",d.a.stringify({lineId:o.lineId,userId:o.userId,statusContent:o.statusContent,longitude:e,latitude:t}),{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then(function(a){if(1e3!=a.data.state)return Object(w.Toast)({message:"添加点位失败",position:"bottom",duration:1e3}),void console.log("添加点位失败");console.log("点位添加成功"),o.myMarker.clearLayers(),console.log("点位清除成功"),console.log(o.myPolyline),null!=o.myPolyline&&o.map.removeLayer(o.myPolyline),o.lines.push([t,e]);for(var n=[],i=0;i<o.lines.length;i++){var s=o.lines[i],r=new L.Marker(s);n.push(r)}o.myMarker=L.layerGroup(n),o.map.addLayer(o.myMarker),o.myPolyline=L.polyline(o.lines,{color:"red"}).addTo(o.map)}).catch(function(t){console.log(t)});else{var n="移动距离"+a+",不足定点距离";Object(w.Toast)({message:n,position:"bottom",duration:1e3})}},getPosition:function(){var t=this;t.endNum++,navigator.geolocation?(t.ifFree=!0,console.log("/* 地理位置服务可用 */"),navigator.geolocation.getCurrentPosition(function(e){var o=e.coords.latitude,a=e.coords.longitude;o-=.0026496046771,a-=-.0058125257492,null==t.myPostion?(console.log("第一次进来"),t.AddMarker(o,a)):(console.log("可以划线"),t.addPolylin(o,a))},function(){console.log("/* 地理位置服务不可用 */")})):console.log("/* 地理位置服务不可用 */")},startPatrol:function(){var t=this;w.MessageBox.confirm("是否确定开始巡检?").then(function(e){var o=t;o.userId=o.getUser().creatUserId,l.a.post(t.SrcApi+"/line/addLine",d.a.stringify({userId:o.userId,statusContent:o.statusContent}),{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then(function(t){1e3==t.data.state?(console.log(t.data.data),o.lineId=t.data.data,o.getPosition(),o.timer=setInterval(o.getPosition,5e3)):console.log("获取线路Id失败")}).catch(function(t){console.log("获取线路Id失败"),console.log(t)})})},windowMapIni:function(){var t=this;null!=t.myPostion?(t.showMap=!t.showMap,t.windowMap=L.map("windowMap",{center:t.myPostion,zoom:15}),L.tileLayer("http://webrd0{s}.is.autonavi.com/appmaptile?lang=zh_cn&size=1&scale=1&style=8&x={x}&y={y}&z={z}",{subdomains:["1","2","3","4"],attribution:"高德"}).addTo(t.windowMap),t.windowMap.on("click",function(e){null!=t.myMarker&&t.myMarker.clearLayers();var o=[],a=[e.latlng.lat,e.latlng.lng],n=new L.Marker(a);o.push(n),t.myMarker=L.layerGroup(o),t.windowMap.addLayer(t.myMarker),t.selectPosition=a,console.log(t.selectPosition)})):Object(w.Toast)({message:"无法获取位置，请开始巡检！",position:"bottom",duration:1e3})},confirm:function(t){2==t&&(this.selectPosition=""),this.showMap=!1,console.log(this.selectPosition)}}},N={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"Free"}},[o("mu-drawer",{attrs:{open:t.showAdd,docked:t.docked,width:"100%",right:"right"===t.position},on:{"update:open":function(e){t.showAdd=e}}},[o("div",{staticStyle:{padding:"15px"}},[o("mu-form",{staticClass:"mu-demo-form",attrs:{model:t.form,enctype:"multipart/form-data","label-position":t.labelPosition,"label-width":"100"}},[o("mu-form-item",{attrs:{prop:"Content",label:"故障内容"}},[o("mu-text-field",{attrs:{"multi-line":"",rows:4,"full-width":"",name:"Content"},model:{value:t.form.Content,callback:function(e){t.$set(t.form,"Content",e)},expression:"form.Content"}})],1),t._v(" "),o("div",{staticStyle:{width:"100%",height:"300px","margin-bottom":"25px"}},[o("ul",t._l(t.items,function(t,e){return o("li",[o("img",{directives:[{name:"preview",rawName:"v-preview",value:t.img_url,expression:"img.img_url"}],staticStyle:{width:"150px",height:"300px",margin:"auto",display:"block"},attrs:{src:t.img_url,alt:t.title,"preview-title-enable":"true","preview-nav-enable":"true"}})])}),0)]),t._v(" "),o("mu-button",{staticStyle:{"margin-bottom":"25px"},attrs:{"full-width":"",color:"primary"},on:{click:t.setImg}},[t._v("拍照")]),t._v(" "),o("mu-button",{staticStyle:{"margin-bottom":"25px"},attrs:{"full-width":"",color:"primary"},on:{click:function(e){return t.windowMapIni()}}},[t._v("选择位置")]),t._v(" "),o("mu-form-item",[o("div",{staticStyle:{display:"flex","justify-content":"center",width:"100%"}},[o("mu-button",{attrs:{color:"primary"},on:{click:t.saveFault}},[t._v("确定")]),t._v(" "),o("mu-button",{on:{click:function(e){t.showAdd=!t.showAdd}}},[t._v("取消")])],1)])],1)],1)]),t._v(" "),o("mu-drawer",{attrs:{open:t.showMap,docked:t.docked,width:"100%",right:"right"===t.position},on:{"update:open":function(e){t.showMap=e}}},[o("div",{staticClass:"windowMapBox"},[o("div",{staticClass:"windowMap",attrs:{id:"windowMap"}}),t._v(" "),o("div",{staticClass:"windowMap-foot",staticStyle:{"text-align":"center"}},[o("div",{staticClass:"windowMap-btn",on:{click:function(e){return t.confirm(1)}}},[t._v("确定")]),t._v(" "),o("div",{staticClass:"windowMap-btn",on:{click:function(e){return t.confirm(2)}}},[t._v("取消")])])])]),t._v(" "),o("mt-header",{attrs:{title:t.msg}},[o("router-link",{attrs:{slot:"left",to:"/"},slot:"left"},[o("mt-button",{attrs:{icon:"back"}},[t._v("返回")])],1),t._v(" "),o("mt-button",{attrs:{slot:"right"},on:{click:function(e){t.showAdd=!t.showAdd}},slot:"right"},[t._v("故障上报")])],1),t._v(" "),o("div",{attrs:{id:"MapFree"}}),t._v(" "),t.ifFree?o("mu-ripple",{staticClass:"footer demo-2",attrs:{color:"yellow",opacity:.5},on:{click:t.endPatrol}},[t._v("结束巡检")]):o("mu-ripple",{staticClass:"footer demo-2",attrs:{color:"yellow",opacity:.5},on:{click:t.startPatrol}},[t._v("开始巡检")])],1)},staticRenderFns:[]};var G=o("C7Lr")(B,N,!1,function(t){o("n3cr")},"data-v-2bfbc26e",null).exports,E={name:"Phone",data:function(){return{msg:"历史记录",active:0,dataList:[],refreshing:!1,loading:!1,isOver:!1,loadTitle:"正在加载。。",dataList2:[],refreshing2:!1,loading2:!1,isOver2:!1,loadTitle2:"正在加载。。",userId:"",page:1,page2:1}},created:function(){this.userId=this.getUser().creatUserId,this.getData(),this.getData2()},methods:{goIndex:function(){this.$router.push({path:"/"})},refresh:function(){this.isOver=!1,this.refreshing=!0,this.page=1,this.getData()},load:function(){this.loading=!0,this.page=this.page+1,this.getData("load")},getData:function(t){var e=this;l.a.post(e.SrcApi+"/line/findLineOfMe",d.a.stringify({userId:this.userId,pageNum:this.page})).then(function(o){if(e.refreshing=!1,e.loading=!1,1e3!=o.data.state)return e.endPatrol(),void console.log("获取故障点位失败");o.data.data.endRow==o.data.data.total&&(e.isOver=!0),"load"==t?(e.dataList=e.dataList.concat(o.data.data.list),console.log("新增成功")):(e.dataList=o.data.data.list,console.log("获取故障点位成功"))}).catch(function(t){console.log(t)})},refresh2:function(){this.isOver2=!1,this.refreshing2=!0,this.page2=1,this.getData2()},load2:function(){this.loading2=!0,this.page2=this.page2+1,this.getData2("load")},getData2:function(t){var e=this;l.a.post(e.SrcApi+"/trouble/findLineOfMe",d.a.stringify({userId:this.userId,pageNum:this.page2})).then(function(o){if(e.refreshing2=!1,e.loading2=!1,1e3!=o.data.state)return e.endPatrol(),void console.log("获取故障点位失败");o.data.data.endRow==o.data.data.total&&(e.isOver2=!0),"load"==t?(e.dataList2=e.dataList2.concat(o.data.data.list),console.log("新增成功")):(e.dataList2=o.data.data.list,console.log("获取故障点位成功"))}).catch(function(t){console.log(t)})},goMap:function(t){null!=t&&this.$router.push({name:"HistoryMap",params:{lineId:t}})},goPosition:function(t){null!=t&&0!=t.length&&this.$router.push({name:"PositionMap",params:{coor:t}})}}},H={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"Phone"}},[o("mt-header",{attrs:{title:t.msg}},[o("router-link",{attrs:{slot:"left",to:"/"},slot:"left"},[o("mt-button",{attrs:{icon:"back"}},[t._v("返回")])],1)],1),t._v(" "),o("mu-tabs",{attrs:{value:t.active,color:"#ef4f4f","indicator-color":"yellow","full-width":""},on:{"update:value":function(e){t.active=e}}},[o("mu-tab",[t._v("自由巡检")]),t._v(" "),o("mu-tab",[t._v("上报故障")])],1),t._v(" "),0===t.active?o("div",{staticClass:"demo-text"},[o("mu-load-more",{attrs:{refreshing:t.refreshing,"loading-text":t.loadTitle,"loaded-all":t.isOver,loading:t.loading},on:{refresh:t.refresh,load:t.load}},t._l(t.dataList,function(e,a){return o("mu-expansion-panel",{key:a},[o("div",{attrs:{slot:"header"},slot:"header"},[t._v(t._s(e.statusContent))]),t._v(" "),o("div",{staticClass:"contentBox"},[o("span",[t._v("巡检名称:")]),t._v("\n          "+t._s(e.statusContent)+"\n        ")]),t._v(" "),o("div",{staticClass:"contentBox"},[o("span",[t._v("时间:")]),t._v("\n          "+t._s(e.createTime)+"\n        ")]),t._v(" "),o("mu-button",{attrs:{slot:"action",flat:"",color:"primary"},on:{click:function(o){return t.goMap(e.id)}},slot:"action"},[t._v("查看")])],1)}),1)],1):t._e(),t._v(" "),1===t.active?o("div",{staticClass:"demo-text"},[o("mu-load-more",{attrs:{refreshing:t.refreshing2,"loading-text":t.loadTitle2,"loaded-all":t.isOver2,loading:t.loading2},on:{refresh:t.refresh2,load:t.load2}},t._l(t.dataList2,function(e,a){return o("mu-expansion-panel",{key:a},[o("div",{attrs:{slot:"header"},slot:"header"},[t._v(t._s(e.content))]),t._v(" "),o("div",{staticClass:"contentBox"},[o("img",{staticStyle:{display:"block",width:"150px",height:"300px",margin:"auto"},attrs:{src:t.SrcApi+e.fileImg,alt:""}})]),t._v(" "),o("div",{staticClass:"contentBox"},[o("span",[t._v("故障内容:")]),t._v("\n          "+t._s(e.content)+"\n        ")]),t._v(" "),o("div",{staticClass:"contentBox"},[o("span",[t._v("上报时间:")]),t._v("\n          "+t._s(e.createTime)+"\n        ")])])}),1)],1):t._e()],1)},staticRenderFns:[]};for(var V=o("C7Lr")(E,H,!1,function(t){o("A5V8")},"data-v-5a001d8a",null).exports,q=[],Z=0;Z<30;Z++){var W={name:"程坤",age:"23",bz:"此处有错误"};q.push(W)}var K={name:"list",data:function(){return{msg:"list",num:q,refreshing:!1,loading:!1,text:"List"}},methods:{refresh:function(){var t=this;this.refreshing=!0,this.$refs.container.scrollTop=0,setTimeout(function(){t.refreshing=!1,t.text="List"===t.text?"Menu":"List",t.num=10},2e3)},load:function(){var t=this;this.loading=!0,setTimeout(function(){t.loading=!1,t.num+=10},2e3)}}},X={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"list"}},[a("mu-load-more",{attrs:{refreshing:t.refreshing,loading:t.loading},on:{refresh:t.refresh,load:t.load}},t._l(t.num,function(e,n){return a("div",{key:n,staticClass:"list-box"},[a("mu-card",[a("mu-card-header",{attrs:{title:"header Title","sub-title":"header Title"}},[a("mu-avatar",{attrs:{slot:"avatar"},slot:"avatar"},[a("img",{attrs:{src:o("9Vsi")}})])],1),t._v(" "),a("mu-card-media",{attrs:{title:"img Title","sub-title":"img Title"}},[a("img",{attrs:{src:o("9Vsi")}})]),t._v(" "),a("mu-card-title",{attrs:{title:"Content Title","sub-title":"Content Title"}}),t._v(" "),a("mu-card-text",[t._v("\n          散落在指尖的阳光，我试着轻轻抓住光影的踪迹，它却在眉宇间投下一片淡淡的阴影。\n          调皮的阳光掀动了四月的心帘，温暖如约的歌声渐起。\n          似乎在诉说着，我也可以在漆黑的角落里，找到阴影背后的阳光，\n          找到阳光与阴影奏出和谐的旋律。我要用一颗敏感赤诚的心迎接每一缕滑过指尖的阳光！\n        ")]),t._v(" "),a("mu-card-actions",[a("mu-button",{attrs:{flat:""}},[t._v("Action 1")]),t._v(" "),a("mu-button",{attrs:{flat:""}},[t._v("Action 2")])],1)],1)],1)}),0)],1)},staticRenderFns:[]};var Y=o("C7Lr")(K,X,!1,function(t){o("qqae")},"data-v-7ed070d8",null).exports,J={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"Phone"}},[a("mu-paper",{staticClass:"demo-list-wrap",attrs:{"z-depth":1}},[a("mu-appbar",{attrs:{color:"lightBlue400"}},[a("mu-button",{attrs:{slot:"left",icon:""},on:{click:function(e){return t.goIndex()}},slot:"left"},[a("mu-icon",{attrs:{value:"menu"}})],1),t._v("联系人\n      ")],1),t._v(" "),a("mu-list",[a("mu-sub-header",[t._v("Today")]),t._v(" "),t._l(t.PhoneData,function(e,n){return a("mu-list-item",{key:n,attrs:{avatar:"",button:"",ripple:!1}},[a("mu-list-item-action",[a("mu-avatar",[a("img",{attrs:{src:o("9Vsi")}})])],1),t._v(" "),a("mu-list-item-content",[a("mu-list-item-title",[t._v(t._s(e.name))]),t._v(" "),a("mu-list-item-sub-title",[t._v(t._s(e.phone))])],1)],1)})],2)],1)],1)},staticRenderFns:[]};var Q=o("C7Lr")({name:"Phone",data:function(){return{msg:"电话资源",PhoneData:[]}},created:function(){this.loadData()},methods:{loadData:function(){for(var t=[],e=0;e<30;e++){var o={name:"程坤",phone:"13977777777"};t.push(o)}this.PhoneData=t},goIndex:function(){this.$router.push({path:"/"})}}},J,!1,function(t){o("C7Wu")},"data-v-67255151",null).exports,tt={name:"Resources",data:function(){return{msg:"线路资源",dataList:null,refreshing:!1,loading:!1,isOver:!1,text:"List",page:1,open:!1,openSelect:!1,docked:!1,position:"right",labelPosition:"top",userList:"",selectValue:"",statusContentList:[{name:"线路任务"}],form:{statusContent:"线路任务",userId:"",toDoId:"",beginTime:"",endTime:""}}},created:function(){this.getData(),this.getUserList()},methods:{show:function(){this.openSelect=!this.openSelect},dataFormat:function(t,e){var o=new Date(t),a=o.getFullYear(),n=o.getMonth()+1,i=o.getDate(),s=o.getHours(),r=o.getMinutes(),l=o.getSeconds();return n=n<10?"0"+n:n,i=i<10?"0"+i:i,s=s<10?"0"+s:s,r=r<10?"0"+r:r,l=l<10?"0"+l:l,e?a+"-"+n+"-"+i+" "+s+":"+r+":"+l:a+"-"+n+"-"+i},add:function(){var t=this;if(null!=t.form.beginTime&&void 0!=t.form.beginTime){var e=this.dataFormat(t.form.beginTime.getTime(),!0);if(null!=t.form.endTime&&void 0!=t.form.endTime){var o=this.dataFormat(t.form.endTime.getTime(),!0);l.a.post(this.SrcApi+"/tasks/addTasks",d.a.stringify({statusContent:t.form.statusContent,userId:t.form.userId,toDoId:t.form.toDoId,beginTime:e,endTime:o}),{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then(function(e){1e3==e.data.state&&(t.open=!t.open,t.getData(),Object(w.Toast)({message:"添加成功",iconClass:"icon icon-success"}))}).catch(function(t){console.log(t)})}}},addTask:function(t){this.form.toDoId=t,this.open=!this.open},getUserList:function(){var t=this;l.a.post(t.SrcApi+"/user/list",d.a.stringify({pageNum:1})).then(function(e){if(1e3!=e.data.state)return t.endPatrol(),void console.log("获取用户信息失败");t.userList=e.data.data.list,console.log("获取用户信息成功")}).catch(function(t){console.log(t)})},getData:function(t){var e=this;l.a.post(this.SrcApi+"/systemLine/list",d.a.stringify({pageNum:e.page})).then(function(o){if(e.refreshing=!1,e.loading=!1,1e3!=o.data.state)return e.endPatrol(),void console.log("获取故障点位失败");o.data.data.endRow==o.data.data.total&&(e.isOver=!0),"load"==t?(e.dataList=e.dataList.concat(o.data.data.list),console.log("新增成功")):(e.dataList=o.data.data.list,console.log("获取故障点位成功"))}).catch(function(t){console.log(t)})},refresh:function(){this.isOver=!1,this.refreshing=!0,this.page=1,this.getData()},load:function(){this.loading=!0,this.page=this.page+1,this.getData("load")},goMap:function(t){this.$router.push({name:"MapCont",params:{lineId:t}})},addPolyline:function(){this.$router.push({name:"addResour"})},select:function(){var t=this;l.a.post(this.SrcApi+"/systemLine/findByNameLike",d.a.stringify({name:t.selectValue}),{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then(function(e){1e3==e.data.state&&(t.dataList=e.data.data)}).catch(function(t){console.log(t)})}}},et={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"Resources"}},[o("mu-drawer",{attrs:{open:t.openSelect,docked:t.docked,width:"100%",right:"right"===t.position},on:{"update:open":function(e){t.openSelect=e}}},[o("mu-form",{staticClass:"mu-demo-form",attrs:{model:t.form,"label-position":t.labelPosition,"label-width":"100"}},[o("mu-form-item",{attrs:{prop:"statusContent",label:"线路类型内容"}},[o("mu-select",{model:{value:t.form.statusContent,callback:function(e){t.$set(t.form,"statusContent",e)},expression:"form.statusContent"}},t._l(t.statusContentList,function(t,e){return o("mu-option",{key:e,attrs:{label:t.name,value:t.name}})}),1)],1),t._v(" "),o("mu-form-item",{attrs:{prop:"userId",label:"任务"}},[o("mu-select",{model:{value:t.form.userId,callback:function(e){t.$set(t.form,"userId",e)},expression:"form.userId"}},t._l(t.userList,function(t,e){return o("mu-option",{key:e,attrs:{label:t.name,value:t.id}})}),1)],1),t._v(" "),o("mu-form-item",[o("mu-button",{attrs:{color:"primary"},on:{click:function(t){}}},[t._v("查询")]),t._v(" "),o("mu-button",{on:{click:function(e){t.openSelect=!t.openSelect}}},[t._v("取消")])],1)],1)],1),t._v(" "),o("mu-drawer",{attrs:{open:t.open,docked:t.docked,width:"100%",right:"right"===t.position},on:{"update:open":function(e){t.open=e}}},[o("mu-form",{staticClass:"mu-demo-form",attrs:{model:t.form,"label-position":t.labelPosition,"label-width":"100"}},[o("mu-form-item",{attrs:{prop:"userId",label:"任务人"}},[o("mu-select",{model:{value:t.form.userId,callback:function(e){t.$set(t.form,"userId",e)},expression:"form.userId"}},t._l(t.userList,function(t,e){return o("mu-option",{key:e,attrs:{label:t.name,value:t.id}})}),1)],1),t._v(" "),o("mu-form-item",{attrs:{prop:"beginTime",label:"开始时间"}},[o("mu-date-input",{attrs:{type:"dateTime","label-float":"","full-width":"",landscape:""},model:{value:t.form.beginTime,callback:function(e){t.$set(t.form,"beginTime",e)},expression:"form.beginTime"}})],1),t._v(" "),o("mu-form-item",{attrs:{prop:"endTime",label:"结束时间"}},[o("mu-date-input",{attrs:{type:"dateTime","label-float":"","full-width":"",landscape:""},model:{value:t.form.endTime,callback:function(e){t.$set(t.form,"endTime",e)},expression:"form.endTime"}})],1),t._v(" "),o("mu-form-item",[o("mu-button",{attrs:{color:"primary"},on:{click:function(e){return t.add()}}},[t._v("提交")]),t._v(" "),o("mu-button",{on:{click:function(e){t.open=!t.open}}},[t._v("取消")])],1)],1)],1),t._v(" "),o("mt-header",{attrs:{title:"线路资源"}},[o("router-link",{attrs:{slot:"left",to:"/"},slot:"left"},[o("mt-button",{attrs:{icon:"back"}})],1)],1),t._v(" "),o("div",{staticStyle:{height:"44px",width:"100%",display:"flex"}},[o("div",{staticStyle:{width:"100%"}},[o("mt-search",{attrs:{"cancel-text":"取消",placeholder:"搜索"},model:{value:t.selectValue,callback:function(e){t.selectValue=e},expression:"selectValue"}})],1),t._v(" "),o("div",{staticStyle:{width:"55px",height:"44px","text-align":"center","line-height":"44px",background:"#d9d9d9",color:"#26a2ff"},on:{click:t.select}},[t._v("确定")])]),t._v(" "),o("div",{staticClass:"content"},[o("mu-load-more",{attrs:{refreshing:t.refreshing,"loading-text":"正在加载..","loaded-all":t.isOver,loading:t.loading},on:{refresh:t.refresh,load:t.load}},t._l(t.dataList,function(e,a){return o("mu-expansion-panel",{key:a},[o("div",{attrs:{slot:"header"},slot:"header"},[t._v(t._s(e.name))]),t._v(" "),o("div",{staticClass:"contentBox"},[o("span",[t._v("名称:")]),t._v("\n          "+t._s(e.name)+"\n        ")]),t._v(" "),o("div",{staticClass:"contentBox"},[o("span",[t._v("类型:")]),t._v("\n          "+t._s(e.statusContent)+"\n        ")]),t._v(" "),o("mu-button",{attrs:{slot:"action",flat:"",color:"primary"},on:{click:function(o){return t.goMap(e.id)}},slot:"action"},[t._v("查看")])],1)}),1)],1),t._v(" "),o("div",{staticClass:"footBtn",on:{click:t.addPolyline}},[t._v("\n    添加\n  ")])],1)},staticRenderFns:[]};var ot=o("C7Lr")(tt,et,!1,function(t){o("HSlS")},"data-v-0d0a18e8",null).exports,at={name:"Task",data:function(){return{msg:"巡检任务",type:"",typeContent:"",toDoId:"",beginTime:"",endTime:"",userId:"",docked:!1,open:!1,position:"right",pickerValue:"",dataList:[],refreshing2:!1,loading2:!1,page2:1,isOver:!1,dataListFalse:[],refreshing:!1,loading:!1,page:1,isOver2:!1,active:0}},methods:{selectCont:function(){},see:function(t){this.$router.push({name:"SeeTask",params:{id:t.toDoId,type:t.statusContent,myLineId:t.myLineId}})},deleteItem:function(t,e){var o=this,a=this;M.a.confirm({title:"标题",message:"是否确定删除该任务？"}).then(function(){l.a.post(o.SrcApi+"/tasks/delTasks",d.a.stringify({id:t.id})).then(function(t){1e3==t.data.state&&(console.log("删除成功"),0==e?a.getDataListFalse():1==e&&a.getDataListTrue())}).catch(function(t){console.log(t)})}).catch(function(){})},getDataList:function(){var t=this;l.a.post(this.SrcApi+"/tasks/list",d.a.stringify({pageNum:1})).then(function(e){1e3==e.data.state&&(console.log("查询成功"),t.dataList=e.data.data.list,console.log(t.dataList))}).catch(function(t){console.log(t)})},getDataListTrue:function(t){var e=this;l.a.post(this.SrcApi+"/tasks/findOfMe",d.a.stringify({userId:e.userId,finish:!0})).then(function(o){if(e.refreshing2=!1,e.loading2=!1,1e3!=o.data.state)return e.endPatrol(),void console.log("获取故障点位失败");o.data.data.endRow==o.data.data.total&&(e.isOver2=!0),"load"==t?(e.dataList=e.dataList.concat(o.data.data),console.log("新增成功")):(e.dataList=o.data.data,console.log("获取故障点位成功"))}).catch(function(t){console.log(t)})},refresh2:function(){this.isOver2=!1,this.refreshing2=!0,this.page2=1,this.getDataListTrue()},load2:function(){this.loading2=!0,this.page2=this.page2+1,this.getDataListTrue("load")},getDataListFalse:function(t){var e=this;l.a.post(this.SrcApi+"/tasks/findOfMe",d.a.stringify({userId:e.userId,finish:!1})).then(function(o){if(e.refreshing=!1,e.loading=!1,1e3!=o.data.state)return e.endPatrol(),void console.log("获取故障点位失败");o.data.data.endRow==o.data.data.total&&(e.isOver=!0),"load"==t?(e.dataListFalse=e.dataListFalse.concat(o.data.data),console.log("新增成功")):(e.dataListFalse=o.data.data,console.log("获取故障点位成功"))}).catch(function(t){console.log(t)})},refresh:function(){this.isOver=!1,this.refreshing=!0,this.page=1,this.getDataListFalse()},load:function(){this.loading=!0,this.page=this.page+1,this.getDataListFalse("load")},showAdd:function(){this.open=!this.open},add:function(){var t=this;if(null!=t.beginTime&&void 0!=t.beginTime){this.dataFormat(t.beginTime.getTime(),!0);if(null!=t.endTime&&void 0!=t.endTime){this.dataFormat(t.endTime.getTime(),!0);l.a.post(this.SrcApi+"/tasks/addTasks",d.a.stringify({type:t.type,typeContent:t.typeContent,toDoId:t.toDoId,beginTime:beginTime,endTime:endTime,userId:t.userId})).then(function(e){1e3==e.data.state&&(t.showAdd(),t.getDataList(),Notify({type:"success",message:"添加成功"}))}).catch(function(t){console.log(t)})}}},dataFormat:function(t,e){var o=new Date(t),a=o.getFullYear(),n=o.getMonth()+1,i=o.getDate(),s=o.getHours(),r=o.getMinutes(),l=o.getSeconds();return n=n<10?"0"+n:n,i=i<10?"0"+i:i,s=s<10?"0"+s:s,r=r<10?"0"+r:r,l=l<10?"0"+l:l,e?a+"-"+n+"-"+i+" "+s+":"+r+":"+l:a+"-"+n+"-"+i}},created:function(){this.userId=this.getUser().id,this.getDataListTrue(),this.getDataListFalse()}},nt={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"header"},[o("mu-drawer",{attrs:{open:t.open,docked:t.docked,width:"100%",right:"right"===t.position},on:{"update:open":function(e){t.open=e}}},[o("mt-field",{attrs:{label:"类型",placeholder:"请输入用户名"},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}}),t._v(" "),o("mt-field",{attrs:{label:"类型类容",placeholder:"请输入类型类容"},model:{value:t.typeContent,callback:function(e){t.typeContent=e},expression:"typeContent"}}),t._v(" "),o("mt-field",{attrs:{label:"任务外键",placeholder:"请输入任务外键"},model:{value:t.toDoId,callback:function(e){t.toDoId=e},expression:"toDoId"}}),t._v(" "),o("div",{staticClass:"window-btn",staticStyle:{"text-align":"center"}},[o("mt-button",{attrs:{type:"primary",size:"normal"},on:{click:function(e){return t.selectCont()}}},[t._v("查询")])],1),t._v(" "),o("div",{staticClass:"window-btn"},[o("mt-button",{attrs:{type:"primary",size:"normal"},on:{click:function(e){t.open=!t.open}}},[t._v("取消")])],1)],1),t._v(" "),o("mt-header",{attrs:{title:t.msg}},[o("router-link",{attrs:{slot:"left",to:"/"},slot:"left"},[o("mt-button",{attrs:{icon:"back"}},[t._v("返回")])],1)],1),t._v(" "),o("div",{staticClass:"content"},[o("mu-tabs",{attrs:{value:t.active,color:"#ef4f4f","indicator-color":"yellow","full-width":""},on:{"update:value":function(e){t.active=e}}},[o("mu-tab",[t._v("未完成")]),t._v(" "),o("mu-tab",[t._v("已完成")])],1),t._v(" "),0===t.active?o("div",{staticClass:"demo-text"},[o("mu-load-more",{attrs:{refreshing:t.refreshing,"loading-text":"正在加载..","loaded-all":t.isOver,loading:t.loading},on:{refresh:t.refresh,load:t.load}},t._l(t.dataListFalse,function(e,a){return o("mu-expansion-panel",{key:a},[o("div",{attrs:{slot:"header"},slot:"header"},[t._v(t._s(e.statusContent))]),t._v(" "),o("div",{staticClass:"contentBox"},[o("span",[t._v("任务人:")]),t._v("\n            "+t._s(e.userId)+"\n          ")]),t._v(" "),o("div",{staticClass:"contentBox"},[o("span",[t._v("类型内容:")]),t._v("\n            "+t._s(e.statusContent)+"\n          ")]),t._v(" "),o("div",{staticClass:"contentBox"},[o("span",[t._v("开始时间:")]),t._v("\n            "+t._s(e.beginTime)+"\n          ")]),t._v(" "),o("div",{staticClass:"contentBox"},[o("span",[t._v("结束时间:")]),t._v("\n            "+t._s(e.endTime)+"\n          ")]),t._v(" "),null!=e.myLineId?o("mu-button",{attrs:{slot:"action",flat:"",color:"primary"},on:{click:function(o){return t.see(e)}},slot:"action"},[t._v("查看")]):t._e()],1)}),1)],1):t._e(),t._v(" "),1===t.active?o("div",{staticClass:"demo-text"},[o("mu-load-more",{attrs:{refreshing:t.refreshing2,"loading-text":"正在加载..","loaded-all":t.isOver2,loading:t.loading2},on:{refresh:t.refresh2,load:t.load2}},t._l(t.dataList,function(e,a){return o("mu-expansion-panel",{key:a},[o("div",{attrs:{slot:"header"},slot:"header"},[t._v(t._s(e.statusContent))]),t._v(" "),o("div",{staticClass:"contentBox"},[o("span",[t._v("任务人:")]),t._v("\n            "+t._s(e.userId)+"\n          ")]),t._v(" "),o("div",{staticClass:"contentBox"},[o("span",[t._v("类型内容:")]),t._v("\n            "+t._s(e.statusContent)+"\n          ")]),t._v(" "),o("div",{staticClass:"contentBox"},[o("span",[t._v("开始时间:")]),t._v("\n            "+t._s(e.beginTime)+"\n          ")]),t._v(" "),o("div",{staticClass:"contentBox"},[o("span",[t._v("结束时间:")]),t._v("\n            "+t._s(e.endTime)+"\n          ")]),t._v(" "),null!=e.myLineId?o("mu-button",{attrs:{slot:"action",flat:"",color:"primary"},on:{click:function(o){return t.see(e)}},slot:"action"},[t._v("查看")]):t._e()],1)}),1)],1):t._e()],1)],1)},staticRenderFns:[]};var it=o("C7Lr")(at,nt,!1,function(t){o("qdC8")},"data-v-2313e624",null).exports,st={name:"ddMap",data:function(){return{msg:"自由巡检"}},created:function(){},mounted:function(){this.getMe()},methods:{getMe:function(){navigator.geolocation?(console.log("/* 地理位置服务可用 */"),navigator.geolocation.getCurrentPosition(this.h5ApiSuccess,this.h5ApiError)):console.log("/* 地理位置服务不可用 */")},h5ApiSuccess:function(t){var e=t.coords.latitude,o=t.coords.longitude;console.log("你的经度纬度分别为"+o+","+e+"。")},h5ApiError:function(){console.log("/* 地理位置请求失败 */")}}},rt={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"MapBox"},[e("div",{attrs:{id:"mapLocation"}})])}]};var lt=o("C7Lr")(st,rt,!1,function(t){o("uWk7")},"data-v-2aa35dfc",null).exports,ct={name:"positionMap",data:function(){return{msg:"历史巡检故障",latlngs:null}},created:function(){this.getPosition()},mounted:function(){this.iniMap()},methods:{getPosition:function(){var t=this.$route.params.coor;void 0!=t&&null!=t&&0!=t.Start.length?this.latlngs=t:this.$router.push({path:"/history"})},iniMap:function(){var t=this;t.map=L.map("map",{center:t.latlngs.Start,zoom:13}),L.tileLayer("http://webrd0{s}.is.autonavi.com/appmaptile?lang=zh_cn&size=1&scale=1&style=8&x={x}&y={y}&z={z}",{subdomains:["1","2","3","4"],attribution:"高德"}).addTo(t.map);var e=L.popup(),o=t.latlngs.Start;L.marker(o).addTo(t.map).on("click",function(o){console.log(o);var a="<div>\n                          <p>名称："+t.latlngs.name+" </p>\n                          <p>坐标："+t.latlngs.Start+"</p>\n                          <p>原因："+t.latlngs.type+"</p>\n                          <p>维修人员："+t.latlngs.type+"</p>\n                        </div>";e.setLatLng(o.latlng).setContent(a).openOn(t.map)})}}},dt={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"MapBox"},[e("div",{attrs:{id:"map"}})])}]};var ut=o("C7Lr")(ct,dt,!1,function(t){o("EaV8")},"data-v-211ca0d8",null).exports,mt={name:"FaultMap",props:{},data:function(){return{msg:"故障定点",map:null}},mounted:function(){this.inIMap()},methods:{inIMap:function(){var t=[this.$route.params.longitude,this.$route.params.latitude];this.map=L.map("faultMap",{center:t,zoom:15}),L.tileLayer("http://webrd0{s}.is.autonavi.com/appmaptile?lang=zh_cn&size=1&scale=1&style=8&x={x}&y={y}&z={z}",{subdomains:["1","2","3","4"],attribution:"高德"}).addTo(this.map);L.popup(),L.marker(t).addTo(this.map)}},created:function(){null!=this.$route.params.longitude&&void 0!=this.$route.params.longitude||this.$router.push({path:"/Fault"})}},pt={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"FaultMap"},[e("mt-header",{attrs:{title:this.msg}},[e("router-link",{attrs:{slot:"left",to:"/Fault"},slot:"left"},[e("mt-button",{attrs:{icon:"back"}},[this._v("返回")])],1)],1),this._v(" "),e("div",{attrs:{id:"faultMap"}})],1)},staticRenderFns:[]};var ft=o("C7Lr")(mt,pt,!1,function(t){o("D50z")},"data-v-70164c2a",null).exports,ht={name:"myUser",props:{},data:function(){return{msg:"用户",userList:null,open:!1,docked:!1,name:"",password:"",userId:"",phone:"",isAdmin:!1,openSelect:!1,selectName:"",refreshing:!1,loading:!1,isOver:!1,page:1}},methods:{handleClose:function(){},goPhone:function(t){window.location.href="tel://"+t},add:function(){var t=this;l.a.post(t.SrcApi+"/user/addUser",d.a.stringify({name:t.name,password:t.password,userId:t.userId,phone:t.phone}),{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then(function(e){1e3==e.data.state?(t.showAdd(),t.getUserList()):console.log("获取用户信息失败")}).catch(function(t){console.log(t)})},selectCont:function(){var t=this;l.a.post(t.SrcApi+"/user/findByNameLike",d.a.stringify({name:t.selectName}),{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then(function(e){1e3==e.data.state?(t.userList=e.data.data,t.selectName="",console.log("获取用户信息成功")):console.log("获取用户信息失败")}).catch(function(t){console.log(t)})},showAdd:function(){this.open=!this.open},deleteUser:function(t){var e=this,o=this;M.a.confirm({title:"提醒信息",message:"是否确定删除该用户？"}).then(function(){l.a.post(e.SrcApi+"/user/delUser",d.a.stringify({id:t.id}),{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then(function(t){1e3==t.data.state&&(console.log("删除成功"),o.getUserList())}).catch(function(t){console.log(t)})}).catch(function(){})},getUserList:function(t){var e=this;l.a.post(e.SrcApi+"/user/list",d.a.stringify({pageNum:this.page})).then(function(o){if(e.refreshing=!1,e.loading=!1,1e3!=o.data.state)return e.endPatrol(),void console.log("获取故障点位失败");o.data.data.endRow==o.data.data.total&&(e.isOver=!0),"load"==t?(e.userList=e.userList.concat(o.data.data.list),console.log("新增成功")):(e.userList=o.data.data.list,console.log("获取故障点位成功"))}).catch(function(t){console.log(t)})},refresh:function(){this.isOver=!1,this.refreshing=!0,this.page=1,this.getUserList()},load:function(){this.loading=!0,this.page=this.page+1,this.getUserList("load")}},created:function(){this.userId=this.getUser().creatUserId,"001"==this.getUser().id&&(this.isAdmin=!0),this.getUserList()}},gt={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"myUser"},[a("mu-drawer",{attrs:{open:t.open,docked:t.docked,width:"100%",right:"right"},on:{"update:open":function(e){t.open=e}}},[a("mt-field",{attrs:{label:"用户名",placeholder:"请输入用户名"},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}}),t._v(" "),a("mt-field",{attrs:{label:"密码",placeholder:"请输入密码"},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}}),t._v(" "),a("mt-field",{attrs:{label:"电话",placeholder:"请输入号码"},model:{value:t.phone,callback:function(e){t.phone=e},expression:"phone"}}),t._v(" "),a("div",{staticClass:"window-btn",staticStyle:{"text-align":"center"}},[a("mt-button",{attrs:{type:"primary",size:"normal"},on:{click:function(e){return t.add()}}},[t._v("添加")])],1),t._v(" "),a("div",{staticClass:"window-btn"},[a("mt-button",{attrs:{type:"primary",size:"normal"},on:{click:function(e){t.open=!t.open}}},[t._v("取消")])],1)],1),t._v(" "),a("mu-drawer",{attrs:{open:t.openSelect,docked:t.docked,width:"100%",right:"right"},on:{"update:open":function(e){t.openSelect=e}}},[a("mt-field",{attrs:{label:"用户名",placeholder:"请输入用户名"},model:{value:t.selectName,callback:function(e){t.selectName=e},expression:"selectName"}}),t._v(" "),a("div",{staticClass:"window-btn",staticStyle:{"text-align":"center"}},[a("mt-button",{attrs:{type:"primary",size:"normal"},on:{click:function(e){return t.selectCont()}}},[t._v("查询")])],1),t._v(" "),a("div",{staticClass:"window-btn"},[a("mt-button",{attrs:{type:"primary",size:"normal"},on:{click:function(e){t.openSelect=!t.openSelect}}},[t._v("取消")])],1)],1),t._v(" "),a("mt-header",{attrs:{title:t.msg}},[a("router-link",{attrs:{slot:"left",to:"/"},slot:"left"},[a("mt-button",{attrs:{icon:"back"}},[t._v("返回")])],1)],1),t._v(" "),a("div",{staticStyle:{height:"44px",width:"100%",display:"flex"}},[a("div",{staticStyle:{width:"100%"}},[a("mt-search",{attrs:{"cancel-text":"取消",placeholder:"搜索"},model:{value:t.selectName,callback:function(e){t.selectName=e},expression:"selectName"}})],1),t._v(" "),a("div",{staticStyle:{width:"55px",height:"44px","text-align":"center","line-height":"44px",background:"#d9d9d9",color:"#26a2ff"},on:{click:t.selectCont}},[t._v("确定")])]),t._v(" "),a("div",{staticClass:"content"},[a("mu-load-more",{attrs:{refreshing:t.refreshing,"loading-text":"正在加载..","loaded-all":t.isOver,loading:t.loading},on:{refresh:t.refresh,load:t.load}},[a("mu-list",t._l(t.userList,function(e,n){return a("mu-list-item",{key:n,attrs:{avatar:"",button:"",ripple:!1}},[a("mu-list-item-action",[a("mu-avatar",[a("img",{attrs:{src:o("9Vsi")}})])],1),t._v(" "),a("mu-list-item-content",{on:{click:function(o){return t.goPhone(e.phone)}}},[a("mu-list-item-title",[t._v(t._s(e.name))]),t._v(" "),a("mu-list-item-sub-title",[t._v(t._s(e.phone))])],1),t._v(" "),1==t.isAdmin?a("mu-list-item-action",[a("mu-button",{attrs:{icon:""},on:{click:function(o){return t.deleteUser(e)}}},[a("mu-icon",{attrs:{value:"info"}})],1)],1):t._e()],1)}),1)],1)],1)],1)},staticRenderFns:[]};var vt=o("C7Lr")(ht,gt,!1,function(t){o("NP8j")},"data-v-715ec0c8",null).exports,yt={name:"addResour",props:{},data:function(){return{msg:"系统线路添加",userId:"",positionList:[],map:null,myPolyline:null,myMarker:null,open:!1,docked:!1,form:{name:"",type:""},typeList:["管道","架空","直埋","附挂","寄挂"],labelPosition:"top"}},methods:{showAdd:function(){this.open=!this.open},add:function(){for(var t=this,e="",o=0;o<t.positionList.length;o++){var a=t.positionList[o];e+=a[0]+"-"+a[1]+","}l.a.post(t.SrcApi+"/systemLine/addLine",d.a.stringify({userId:t.userId,statusContent:t.form.type,name:t.form.name,list:e}),{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then(function(e){1e3==e.data.state?t.showAdd():console.log("获取用户信息失败")}).catch(function(t){console.log(t)})},deletePosition:function(){null!=this.myPolyline&&this.map.removeLayer(this.myPolyline),null!=this.myMarker&&this.myMarker.clearLayers(),this.positionList.pop();for(var t=[],e=0;e<this.positionList.length;e++){var o=this.positionList[e],a=new L.Marker(o);t.push(a)}this.myMarker=L.layerGroup(t),this.map.addLayer(this.myMarker),this.myPolyline=L.polyline(this.positionList,{color:"red"}).addTo(this.map)},addMarker:function(t){var e=[t.lat,t.lng];this.positionList.push(e),null!=this.myPolyline&&this.map.removeLayer(this.myPolyline),null!=this.myMarker&&this.myMarker.clearLayers();for(var o=[],a=0;a<this.positionList.length;a++){var n=this.positionList[a],i=new L.Marker(n);o.push(i)}this.myMarker=L.layerGroup(o),this.map.addLayer(this.myMarker),this.myPolyline=L.polyline(this.positionList,{color:"red"}).addTo(this.map)},mapIni:function(){var t=this;t.map=L.map("map",{center:[29.37,113.09],zoom:15}),L.tileLayer("http://webrd0{s}.is.autonavi.com/appmaptile?lang=zh_cn&size=1&scale=1&style=8&x={x}&y={y}&z={z}",{subdomains:["1","2","3","4"],attribution:"高德"}).addTo(t.map);L.popup();t.map.on("click",function(e){t.addMarker(e.latlng)})}},mounted:function(){this.mapIni()},created:function(){this.userId=this.getUser().creatUserId}},wt={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"addResour"},[o("mu-drawer",{attrs:{open:t.open,docked:t.docked,width:"100%",right:"right"},on:{"update:open":function(e){t.open=e}}},[o("mu-form",{staticClass:"mu-demo-form",attrs:{model:t.form,"label-position":t.labelPosition,"label-width":"100"}},[o("mu-form-item",{attrs:{prop:"name",label:"线路名称"}},[o("mu-text-field",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),o("mu-form-item",{attrs:{prop:"type",label:"线路类型"}},[o("mu-select",{model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},t._l(t.typeList,function(t,e){return o("mu-option",{key:e,attrs:{label:t,value:t}})}),1)],1),t._v(" "),o("mu-form-item",[o("mu-button",{attrs:{color:"primary"},on:{click:function(e){return t.add()}}},[t._v("提交")]),t._v(" "),o("mu-button",{on:{click:function(e){return t.showAdd()}}},[t._v("取消")])],1)],1)],1),t._v(" "),o("mt-header",{attrs:{title:t.msg}},[o("router-link",{attrs:{slot:"left",to:"/resources"},slot:"left"},[o("mt-button",{attrs:{icon:"back"}},[t._v("返回")])],1)],1),t._v(" "),o("div",{attrs:{id:"map"}}),t._v(" "),o("mu-ripple",{staticClass:"footer demo-2 left",attrs:{color:"yellow",opacity:.5},on:{click:function(e){return t.showAdd()}}},[t._v("添加")]),t._v(" "),o("mu-ripple",{staticClass:"footer demo-2 right",attrs:{color:"yellow",opacity:.5},on:{click:function(e){return t.deletePosition()}}},[t._v("删除")])],1)},staticRenderFns:[]};var _t=o("C7Lr")(yt,wt,!1,function(t){o("C2g4")},"data-v-3ec6ff08",null).exports,Lt={name:"seeTask",props:{},data:function(){var t;return t={msg:"查看任务",id:"",type:"",latlngs:[],ifFree:!1,timer:null,myPosition:null,statusContent:"任务巡检",lineId:null,userId:null,showAdd:!1,docked:!1,position:"right",labelPosition:"top",param:new FormData,img_w:window.screen.width/33.333*.94*.5+"rem",form:{Content:""},open:!1,minImg:null},$()(t,"userId",""),$()(t,"img",U.a),$()(t,"items",[{title:"图片查看",img_url:o("MyR+")}]),$()(t,"showMap",!1),$()(t,"windowMap",null),$()(t,"selectPosition",null),$()(t,"myMarker",null),$()(t,"endNum",0),$()(t,"selectWindowMap",""),t},mounted:function(){this.iniMap()},methods:{handleClose:function(){},mapCoorIni:function(){null!=this.$route.params.id&&null!=this.$route.params.type?(this.id=this.$route.params.id,this.type=this.$route.params.type,this.lineId=this.$route.params.myLineId,console.log("进入地图")):this.$router.push({path:"/Task"})},iniMap:function(){var t=this;"线路任务"==t.type&&l.a.post(this.SrcApi+"/systemLine/gpsOfLine",d.a.stringify({lineId:t.id}),{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then(function(e){if(1e3==e.data.state)if(null!=e.data.data&&0!=e.data.data.length){for(var o=e.data.data,a=0;a<o.length;a++){var n=[o[a].latitude,o[a].longitude];t.latlngs.push(n)}t.map=L.map("TaskMap",{center:t.latlngs[0],zoom:15}),L.tileLayer("http://webrd0{s}.is.autonavi.com/appmaptile?lang=zh_cn&size=1&scale=1&style=8&x={x}&y={y}&z={z}",{subdomains:["1","2","3","4"],attribution:"高德"}).addTo(t.map);for(var i=0;i<t.latlngs.length;i++){var s=t.latlngs[i];L.marker(s).addTo(t.map)}var r=t.latlngs;L.polyline(r,{color:"red"}).addTo(t.map)}else t.$router.push({path:"/Task"});else t.$router.push({path:"/Task"})}).catch(function(t){console.log(t)})},startPatrol:function(){var t=this,e=this;w.MessageBox.confirm("是否确定开始巡检?").then(function(o){navigator.geolocation?(console.log("/* 地理位置服务可用 */"),navigator.geolocation.getCurrentPosition(function(t){var o=t.coords.latitude,a=t.coords.longitude;o-=.0026496046771,a-=-.0058125257492,e.addPolylin(o,a,0),e.ifFree=!0,e.timer=setInterval(e.getPosition,3e3)},function(){console.log("/* 地理位置请求失败 */"),w.MessageBox.alert("地理位置请求失败,请打开定位设置!").then(function(t){e.ifFree=!1,window.clearTimeout(e.timer)})},{enableHighAccuracy:!0,timeout:5e3,maximumAge:1e3})):(console.log("/* 地理位置服务不可用 */"),w.MessageBox.alert("地理位置请求失败,请打开定位设置!").then(function(e){var o=t;o.ifFree=!1,window.clearTimeout(o.timer)}))})},getPosition:function(){var t=this;if(navigator.geolocation)console.log("/* 地理位置服务可用 */"),navigator.geolocation.getCurrentPosition(function(e){var o=e.coords.latitude,a=e.coords.longitude;o-=.0026496046771,a-=-.0058125257492,t.addPolylin(o,a,1)},function(){console.log("/* 地理位置请求失败 */"),t.ifFree=!1,window.clearTimeout(t.timer),Object(w.Toast)({message:"定位失败，停止巡检，请重新开始巡检",position:"bottom",duration:1e3})},{enableHighAccuracy:!0,timeout:5e3,maximumAge:1e3});else{console.log("/* 地理位置服务不可用 */");this.ifFree=!1,window.clearTimeout(this.timer),Object(w.Toast)({message:"定位失败，停止巡检，请重新开始巡检",position:"bottom",duration:1e3})}},addPolylin:function(t,e,o){if(console.log(o),1==o)var a=L.latLng(this.myPostion).distanceTo(L.latLng([t,e]));else a=1e4;if(console.log(a),a>=50)this.myPostion=[t,e],l.a.post(this.SrcApi+"/gps/addGps",d.a.stringify({lineId:this.lineId,userId:this.userId,statusContent:this.statusContent,longitude:e,latitude:t}),{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then(function(t){if(1e3!=t.data.state)return Object(w.Toast)({message:"位置上报失败",position:"bottom",duration:1e3}),void console.log("添加点位失败");Object(w.Toast)({message:"位置已上报",position:"bottom",duration:1e3})}).catch(function(t){console.log(t)});else{var n="移动距离"+a+",不足定点距离";Object(w.Toast)({message:n,position:"bottom",duration:1e3})}},endPatrol:function(){console.log("结束巡检");this.ifFree=!1,window.clearTimeout(this.timer)},update:function(t){var e=j()(this.$el).find("#imgLocal")[0].files[0];console.log(j()(this.$el).find("#imgLocal")[0].files),self.img=j()(this.$el).find("#imgLocal")[0].files[0],(new FormData).append("imgFile",e)},saveFault:function(){var t=this,e=new FormData;console.log(t.minImg),e.append("imgFile",t.minImg),e.append("userId",t.userId),null!=t.form.Content&&""!=t.form.Content&&(e.append("content",t.form.Content),null!=t.selectPosition&&0!=t.selectPosition.length&&(e.append("longitude",t.selectPosition[1]),e.append("latitude",t.selectPosition[0]),console.log(e),console.log(e.get("imgFile")),l.a.post(this.SrcApi+"/trouble/addTrouble",e).then(function(e){1e3==e.data.state?(t.showAdd=!t.showAdd,w.MessageBox.alert("上报成功","操作")):(t.showAdd=!t.showAdd,w.MessageBox.alert("上传失败请重新上传","操作")),console.log(e.data.state),console.log(e.data.message)}).catch(function(t){console.log(t)})))},saveImg:function(){var t=this;console.log("图片地址"+t.$store.state.user.icon),plus.gallery.save(t.$store.state.user.icon,function(){t.$toast.success("保存图片到相册成功"),t.open=!1},function(){t.$toast.error("保存失败")})},getBase64Image:function(t){var e=this,o=new Image;o.src=t,o.onload=function(){var t=o,a=t.width,n=t.height,i=a/n;n=(a=320)/i;var s=document.createElement("canvas"),r=s.getContext("2d");j()(s).attr({width:a,height:n}),r.drawImage(t,0,0,a,n);var l=s.toDataURL("image/png","image/jpeg","image/jpg",1);console.log(l),e.minImg=l}},setImg:function(){var t=this;plus.camera.getCamera().captureImage(function(e){plus.io.resolveLocalFileSystemURL(e,function(e){t.minImg=t.getBase64Image(e.toLocalURL()),t.items[0].img_url=e.toLocalURL()},function(t){})},function(t){},{filename:"_doc/camera/"})},resolveImg:function(t){this.open=!1;var e=this,o=t.substr(t.lastIndexOf("/")+1);plus.io.resolveLocalFileSystemURL(t,function(a){a.file(function(a){a.size;plus.zip.compressImage({src:t,dst:"_doc/"+o,width:"100%",quality:100,overwrite:!0},function(t){console.log("压缩成功--\x3e"+t.target);var o=new Image;o.src=t.target,o.style.width="60px",o.style.height="60px",e.minImg=e.getBase64Image(o)})})},function(t){alert("Resolve file URL failed: "+t.message)})},windowMapIni:function(){var t=this;if(null==t.myPostion)return t.selectWindowMap="无法获取位置，请开始巡检！",void Object(w.Toast)({message:"无法获取位置，请开始巡检！",position:"bottom",duration:1e3});t.selectWindowMap="",t.showMap=!t.showMap,t.windowMap=L.map("windowMap",{center:t.myPostion,zoom:15}),L.tileLayer("http://webrd0{s}.is.autonavi.com/appmaptile?lang=zh_cn&size=1&scale=1&style=8&x={x}&y={y}&z={z}",{subdomains:["1","2","3","4"],attribution:"高德"}).addTo(t.windowMap),t.windowMap.on("click",function(e){null!=t.myMarker&&t.myMarker.clearLayers();var o=[],a=[e.latlng.lat,e.latlng.lng],n=new L.Marker(a);o.push(n),t.myMarker=L.layerGroup(o),t.windowMap.addLayer(t.myMarker),t.selectPosition=a,console.log(t.selectPosition)})},confirm:function(t){2==t&&(this.selectPosition=""),this.showMap=!1,console.log(this.selectPosition)}},destroyed:function(){this.ifFree?(console.log("清除定时器"),this.endPatrol()):console.log("定时器未开启")},created:function(){this.mapCoorIni(),this.userId=this.getUser().id}},bt={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"seeTask"},[o("mu-drawer",{attrs:{open:t.showAdd,docked:t.docked,width:"100%",right:"right"===t.position},on:{"update:open":function(e){t.showAdd=e}}},[o("div",{staticStyle:{padding:"15px"}},[o("mu-form",{staticClass:"mu-demo-form",attrs:{model:t.form,enctype:"multipart/form-data","label-position":t.labelPosition,"label-width":"100"}},[o("mu-form-item",{attrs:{prop:"Content",label:"故障内容"}},[o("mu-text-field",{attrs:{"multi-line":"",rows:4,"full-width":"",name:"Content"},model:{value:t.form.Content,callback:function(e){t.$set(t.form,"Content",e)},expression:"form.Content"}})],1),t._v(" "),o("div",{staticStyle:{width:"100%",height:"300px","margin-bottom":"25px"}},[o("ul",t._l(t.items,function(t,e){return o("li",[o("img",{directives:[{name:"preview",rawName:"v-preview",value:t.img_url,expression:"img.img_url"}],staticStyle:{width:"150px",height:"300px",margin:"auto",display:"block"},attrs:{src:t.img_url,alt:t.title,"preview-title-enable":"true","preview-nav-enable":"true"}})])}),0)]),t._v(" "),o("mu-button",{staticStyle:{"margin-bottom":"25px"},attrs:{"full-width":"",color:"primary"},on:{click:t.setImg}},[t._v("拍照")]),t._v(" "),o("span",{staticStyle:{color:"red"}},[t._v(t._s(t.selectWindowMap))]),t._v(" "),o("mu-button",{staticStyle:{"margin-bottom":"25px"},attrs:{"full-width":"",color:"primary"},on:{click:function(e){return t.windowMapIni()}}},[t._v("选择位置")]),t._v(" "),o("mu-form-item",[o("div",{staticStyle:{display:"flex","justify-content":"center",width:"100%"}},[o("mu-button",{attrs:{color:"primary"},on:{click:t.saveFault}},[t._v("确定")]),t._v(" "),o("mu-button",{on:{click:function(e){t.showAdd=!t.showAdd}}},[t._v("取消")])],1)])],1)],1)]),t._v(" "),o("mu-drawer",{attrs:{open:t.showMap,docked:t.docked,width:"100%",right:"right"===t.position},on:{"update:open":function(e){t.showMap=e}}},[o("div",{staticClass:"windowMapBox"},[o("div",{staticClass:"windowMap",attrs:{id:"windowMap"}}),t._v(" "),o("div",{staticClass:"windowMap-foot",staticStyle:{"text-align":"center"}},[o("div",{staticClass:"windowMap-btn",on:{click:function(e){return t.confirm(1)}}},[t._v("确定")]),t._v(" "),o("div",{staticClass:"windowMap-btn",on:{click:function(e){return t.confirm(2)}}},[t._v("取消")])])])]),t._v(" "),o("mt-header",{attrs:{title:t.msg}},[o("router-link",{attrs:{slot:"left",to:"/task"},slot:"left"},[o("mt-button",{attrs:{icon:"back"}},[t._v("返回")])],1),t._v(" "),o("mt-button",{attrs:{slot:"right"},on:{click:function(e){t.showAdd=!t.showAdd}},slot:"right"},[t._v("故障上报")])],1),t._v(" "),o("div",{attrs:{id:"TaskMap"}}),t._v(" "),t.ifFree?o("mu-ripple",{staticClass:"footer demo-2",attrs:{color:"yellow",opacity:.5},on:{click:t.endPatrol}},[t._v("结束巡检")]):o("mu-ripple",{staticClass:"footer demo-2",attrs:{color:"yellow",opacity:.5},on:{click:t.startPatrol}},[t._v("开始巡检")])],1)},staticRenderFns:[]};var kt=o("C7Lr")(Lt,bt,!1,function(t){o("O0R5")},"data-v-25167cbf",null).exports,Ct={name:"HomeHead",props:{},data:function(){return{msg:"修改密码",oldPassword:"",password:"",pwdSta:"",pwdStaOld:"",username:""}},methods:{handleClose:function(){},modify:function(){var t=this;""!=this.oldPassword?""!=this.password?this.oldPassword==this.getUser().password?l.a.post(this.SrcApi+"/user/upDatePassword",d.a.stringify({oldPassword:t.oldPassword,username:t.username,password:t.password}),{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then(function(e){1e3==e.data.state&&(Object(w.Toast)({message:e.data.message,iconClass:"icon icon-success"}),t.$router.push({path:"/logion"}))}).catch(function(t){console.log(t),Object(w.Toast)({message:t,iconClass:"icon icon-success"})}):this.pwdStaOld="error":this.pwdSta="error":this.pwdStaOld="error"}},created:function(){this.username=this.getUser().name}},xt={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"modify"},[t._m(0),t._v(" "),o("div",{staticClass:"box"},[o("mt-field",{attrs:{label:"旧密码",state:t.pwdStaOld,placeholder:"请输入密码",type:"password"},model:{value:t.oldPassword,callback:function(e){t.oldPassword=e},expression:"oldPassword"}}),t._v(" "),o("div",{staticClass:"Dboorder"}),t._v(" "),o("mt-field",{attrs:{label:"密码",state:t.pwdSta,placeholder:"请输入密码",type:"password"},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}}),t._v(" "),o("div",{staticClass:"Dboorder"}),t._v(" "),o("mt-button",{staticClass:"loginBtn",attrs:{type:"danger",size:"large"},on:{click:t.modify}},[t._v("确定")]),t._v(" "),o("router-link",{staticClass:"returnBtn",attrs:{to:"/"}},[t._v("取消修改")])],1)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"logo"},[e("img",{attrs:{src:o("dLd/")}})])}]};var It=o("C7Lr")(Ct,xt,!1,function(t){o("FGKU")},"data-v-10c8284f",null).exports;a.default.use(s.a);var Tt=new s.a({routes:[{path:"/",name:"Index",component:T},{path:"/logion",name:"Logion",component:C},{path:"/historyMap",name:"HistoryMap",component:g},{path:"/map",name:"MapCont",component:p},{path:"/fault",name:"Fault",component:F},{path:"/free",name:"Free",component:G},{path:"/history",name:"History",component:V},{path:"/list",name:"List",component:Y},{path:"/phone",name:"Phone",component:Q},{path:"/resources",name:"Resources",component:ot},{path:"/locationMap",name:"LocationMap",component:lt},{path:"/positionMap",name:"PositionMap",component:ut},{path:"/task",name:"Task",component:it},{path:"/faultMap",name:"faultMap",component:ft},{path:"/myUser",name:"myUser",component:vt},{path:"/addResour",name:"addResour",component:_t},{path:"/SeeTask",name:"SeeTask",component:kt},{path:"/modify",name:"Modify",component:It}]}),Mt=(o("9n10"),o("M6Sr"),o("TzC8"),o("5OHe"),o("n4oI"),o("xwKP")),Pt=(o("C4aK"),o("wEua"));o("Z7KP");a.default.use(_.a),Pt.a.config({position:"top",time:1e3}),a.default.use(Mt.a),a.default.use(Pt.a),a.default.use(M.a),a.default.use(M.b),a.default.use(z.a),a.default.prototype.SrcApi="http://139.9.84.110:8899",a.default.prototype.getLogion=function(t){if(window.plus)var e=plus.storage.getItem("appUser");else e=localStorage.getItem("appUser");void 0!=e&null!=e&""!=e||this.$router.push({path:"/logion"})},a.default.prototype.getUser=function(){if(window.plus)var t=plus.storage.getItem("appUser");else t=localStorage.getItem("appUser");return JSON.parse(t)},new a.default({el:"#app",router:Tt,axios:l.a,components:{App:i},template:"<App/>"})},NP8j:function(t,e){},O0R5:function(t,e){},TzC8:function(t,e){},VxGX:function(t,e){},Z7KP:function(t,e){},"dLd/":function(t,e,o){t.exports=o.p+"static/img/logo.e831b60.png"},hTWl:function(t,e){},"k/K1":function(t,e){},kuOz:function(t,e){},n3cr:function(t,e){},n4oI:function(t,e){},qdC8:function(t,e){},qqae:function(t,e){},qqfu:function(t,e){},uWk7:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.e0f211f56ed8f4e161dd.js.map